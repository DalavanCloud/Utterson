#!/usr/bin/env ruby

require 'csv'
results = CSV.read 'results.csv', headers: true, converters: :numeric

puts "| ref                                      | build time in seconds |"
puts "|------------------------------------------|----------------------:|"

summed_results = {}
results.each{ |row|
  summed_results[row[0]] = 0.0 unless summed_results.has_key?(row[0])
  summed_results[row[0]] += row[1]
}

summed_results.each { |ref,time|
  ref = "`#{ref}`" unless ref.match(/\A(?:[0-9a-f]+|#\d+)\Z/)
  puts "| %-40s | %21.2f |" % [ref,time]
}
